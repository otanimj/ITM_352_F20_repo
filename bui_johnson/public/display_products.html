<head>
    <meta charset="utf-8">
    <meta name="author" content="Tyler Johnson">
    <meta name="description" content="Displays products">
    <!-- Add responsive design on smaller screens -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Import Bootstrap CSS library -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <!-- Own CSS style -->
    <link rel="stylesheet" href="css/style.css">
    <title>Lululemon Store</title>

    <script src="./functions.js"></script>
    <script>

        // get the query string
        let params = (new URL(document.location)).searchParams;
        if (params.has('products_key')) {
            var products_key = params.get('products_key');
        } else {
            document.write('no products key in query string');
            document.stop;
        }

        var products_data;
        loadJSON('get_products_data', function (response) {
            // Parsing JSON string into object
            products_data = JSON.parse(response);
        });
    </script>
</head>
<center>
    <script> nav_bar(products_key, products_data);</script>
</center>


<div class="container">
    <div class="row justify-content-center text-center">
        <div class="log-in">LULULEMON PRODUCTS</div>
    </div>
    <div class="row">
        <script>

            // This function takes a string assumed to be a key in the products array above to display and select the corresponding products
            var order_str = '';
            // get the particular products to display
            products = products_data[products_key];
            if (params.has('Submit')) {
                // grab the quantities from the query string
                order_str = 'Your order is:<br>';
                for (i = 0; i < products.length; i++) {
                    order_str += `You want ${params.get(`quantities[${i}]`)} of ${products[i]['model']}<br>`;
                }
            } else {
                order_str += `<h1>Please select what ${products_key} you want</h1><br>`;
                // We put the whole table in the form so that anything entered in it will get submitted

                for (i = 0; i < products.length; i++) { //Main page content
                    order_str += `
                    <div class="card col-3">
<img class="card-img-top" src="./imgs/${products[i]['image']}" alt="Card image cap">
   <div class="card-body">
       
       <span class="card-text float-left"> ${products[i]['model']}
           <br> <p style="color:#8695A5">${products[i]['color']}</p></span>
       <span class="price float-right">$${products[i]['price']}</span>
   </div>         
   <label id="products${i}_label"}>Quantity</label>
   <input type="text" placeholder="0" name="quantity${i}" 
onkeyup="checkQuantityTextbox(this);">
</div>`;
                }
                order_str += `
<INPUT TYPE="SUBMIT"  name="Submit" value="Select">
</FORM>`;
            } // this closes the else for the form and table display
            document.write(order_str);
        </script>
    </div>
</div>